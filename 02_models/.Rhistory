BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
dt_panel_5 =
data.frame(
scenario = c(
rep("Healty site", nrow(no_stress)),
rep("Baseline outbreak",nrow(baseline_outbreak)),
rep("Proactive strategy",nrow(proactive_strategy)),
rep("Proactive strategy - Too late",nrow(proactive_strategy_toolate)),
rep("Reactive strategy",nrow(reactive_strategy))
),
equi.lost.survi.ad = c(
0,
no_stress$nb_adults_equi - baseline_outbreak$nb_adults_equi,
no_stress$nb_adults_equi - proactive_strategy$nb_adults_equi,
no_stress$nb_adults_equi - proactive_strategy_toolate$nb_adults_equi,
no_stress$nb_adults_equi - reactive_strategy$nb_adults_equi
),
nb_infected_colonies = c(
no_stress$nb_infected_colonies,
baseline_outbreak$nb_infected_colonies,
proactive_strategy$nb_infected_colonies,
proactive_strategy_toolate$nb_infected_colonies,
reactive_strategy$nb_infected_colonies
),
infected_X_time = c(
no_stress$infected_X_time,
baseline_outbreak$infected_X_time,
proactive_strategy$infected_X_time,
proactive_strategy_toolate$infected_X_time,
reactive_strategy$infected_X_time
)
) %>%
mutate(scenario = factor(scenario, levels = c("Healty site",
"Baseline outbreak",
"Proactive strategy",
"Proactive strategy - Too late",
"Reactive strategy")))
p_equi.survi.ad = ggplot()+
geom_violin(data = dt_panel_5,
aes(x = scenario, y = equi.lost.survi.ad),
fill = "lightblue",
color = "white",
trim=FALSE, position=position_dodge(1)) +
geom_dotplot(data = dt_panel_5, aes(x = scenario, y = equi.lost.survi.ad),
binaxis='y', stackdir='center',
binwidth = 2,
color = "darkgrey", alpha = 0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = equi.lost.survi.ad),
binaxis='y', stackdir='center',
binwidth = 6,
fill = "lightblue",
color = "white",
stackratio=0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = equi.lost.survi.ad),
binaxis='y', stackdir='center',
binwidth = 1,
fill = "darkgrey",
color = "darkgrey",
stackratio=0.5)+
ggthemes::theme_clean() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_blank(), # Enlever la bordure du panel
axis.title = element_text(size = 11),  # Thicken axis titles
axis.text = element_text(size = 10),  # Thicken axis text
axis.line = element_line(linewidth = 2),  # Thicken axis lines
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
legend.position =  "none"
)+
ylim(0, NA)+
labs(x = "Scenario", y = "ENLA")
p_nb_infected_colonies = ggplot()+
geom_violin(data = dt_panel_5,
aes(x = scenario, y = nb_infected_colonies),
fill = "burlywood1",
color = "white",
trim=FALSE, position=position_dodge(1)) +
geom_dotplot(data = dt_panel_5,
aes(x = scenario, y = nb_infected_colonies),
binaxis='y', stackdir='center',
binwidth = 0.04,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = nb_infected_colonies),
binaxis='y', stackdir='center',
binwidth = 0.15,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
ggthemes::theme_clean() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_blank(), # Enlever la bordure du panel
axis.title = element_text(size = 11),  # Thicken axis titles
axis.text = element_text(size = 10),  # Thicken axis text
axis.line = element_line(linewidth = 2),  # Thicken axis lines
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
legend.position =  "none"
)+
ylim(0, 4)+
labs(x = "Scenario", y = "Number of infected colonies")
p_infected_X_time = ggplot()+
geom_violin(data = dt_panel_5,
aes(x = scenario, y = infected_X_time),
fill = "lightgreen",
color = "white",
trim=FALSE, position=position_dodge(1)) +
geom_dotplot(data = dt_panel_5,
aes(x = scenario, y = infected_X_time),
binaxis='y', stackdir='center',
binwidth = 0.04,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = infected_X_time),
binaxis='y', stackdir='center',
binwidth = 0.15,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
ggthemes::theme_clean() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_blank(), # Enlever la bordure du panel
axis.title = element_text(size = 11),  # Thicken axis titles
axis.text = element_text(size = 10),  # Thicken axis text
axis.line = element_line(linewidth = 2),  # Thicken axis lines
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
legend.position =  "none"
)+
ylim(0, NA)+
labs(x = "Scenario", y = "Infected x Time")
p = plot_grid(p_equi.survi.ad,
p_infected_X_time,
p_nb_infected_colonies,
labels = c("A", "B", "C"),
ncol = 3)
print(p)
}
scenario_plot(beta_context = 0.5,
time_at_sea_NB_context = 40)
scenario_plot = function(beta_context,
time_at_sea_NB_context
){
no_stress =
stat_model(nb_iterations_ = 1,
induced_dispersal_ = F,
initial_number_infected_breeders_A_ = 0,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
baseline_outbreak =
stat_model(induced_dispersal_ = F,
initial_number_infected_breeders_A_ = 1,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
proactive_strategy =
stat_model(nb_iterations_ = 1,
induced_dispersal_ = T,
initial_number_infected_breeders_A_ = 0,
dispersal_stochactic_ = F,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
proactive_strategy_toolate =
stat_model(induced_dispersal_ = T,
initial_number_infected_breeders_A_ = 1,
dispersal_stochactic_ = F,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
reactive_strategy =
stat_model(induced_dispersal_ = T,
initial_number_infected_breeders_A_ = 1,
dispersal_stochactic_ = T,
dispersal_reaction_time_ = 2,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
dt_panel_5 =
data.frame(
scenario = c(
rep("Healty site", nrow(no_stress)),
rep("Baseline outbreak",nrow(baseline_outbreak)),
rep("Proactive strategy",nrow(proactive_strategy)),
rep("Proactive strategy - Too late",nrow(proactive_strategy_toolate)),
rep("Reactive strategy",nrow(reactive_strategy))
),
equi.lost.survi.ad = c(
0,
no_stress$nb_adults_equi - baseline_outbreak$nb_adults_equi,
no_stress$nb_adults_equi - proactive_strategy$nb_adults_equi,
no_stress$nb_adults_equi - proactive_strategy_toolate$nb_adults_equi,
no_stress$nb_adults_equi - reactive_strategy$nb_adults_equi
),
nb_infected_colonies = c(
no_stress$nb_infected_colonies,
baseline_outbreak$nb_infected_colonies,
proactive_strategy$nb_infected_colonies,
proactive_strategy_toolate$nb_infected_colonies,
reactive_strategy$nb_infected_colonies
),
infected_X_time = c(
no_stress$infected_X_time,
baseline_outbreak$infected_X_time,
proactive_strategy$infected_X_time,
proactive_strategy_toolate$infected_X_time,
reactive_strategy$infected_X_time
)
) %>%
mutate(scenario = factor(scenario, levels = c("Healty site",
"Baseline outbreak",
"Proactive strategy",
"Proactive strategy - Too late",
"Reactive strategy")))
p_equi.survi.ad = ggplot()+
geom_violin(data = dt_panel_5,
aes(x = scenario, y = equi.lost.survi.ad),
fill = "lightblue",
color = "white",
trim=FALSE, position=position_dodge(1)) +
geom_dotplot(data = dt_panel_5, aes(x = scenario, y = equi.lost.survi.ad),
binaxis='y', stackdir='center',
binwidth = 2,
color = "darkgrey", alpha = 0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = equi.lost.survi.ad),
binaxis='y', stackdir='center',
binwidth = 7,
fill = "lightblue",
color = "white",
stackratio=0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = equi.lost.survi.ad),
binaxis='y', stackdir='center',
binwidth = 3,
fill = "darkgrey",
color = "darkgrey",
stackratio=0.5)+
ggthemes::theme_clean() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_blank(), # Enlever la bordure du panel
axis.title = element_text(size = 11),  # Thicken axis titles
axis.text = element_text(size = 10),  # Thicken axis text
axis.line = element_line(linewidth = 2),  # Thicken axis lines
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
legend.position =  "none"
)+
ylim(0, NA)+
labs(x = "Scenario", y = "ENLA")
p_nb_infected_colonies = ggplot()+
geom_violin(data = dt_panel_5,
aes(x = scenario, y = nb_infected_colonies),
fill = "burlywood1",
color = "white",
trim=FALSE, position=position_dodge(1)) +
geom_dotplot(data = dt_panel_5,
aes(x = scenario, y = nb_infected_colonies),
binaxis='y', stackdir='center',
binwidth = 0.04,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = nb_infected_colonies),
binaxis='y', stackdir='center',
binwidth = 0.15,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
ggthemes::theme_clean() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_blank(), # Enlever la bordure du panel
axis.title = element_text(size = 11),  # Thicken axis titles
axis.text = element_text(size = 10),  # Thicken axis text
axis.line = element_line(linewidth = 2),  # Thicken axis lines
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
legend.position =  "none"
)+
ylim(0, 4)+
labs(x = "Scenario", y = "Number of infected colonies")
p_infected_X_time = ggplot()+
geom_violin(data = dt_panel_5,
aes(x = scenario, y = infected_X_time),
fill = "lightgreen",
color = "white",
trim=FALSE, position=position_dodge(1)) +
geom_dotplot(data = dt_panel_5,
aes(x = scenario, y = infected_X_time),
binaxis='y', stackdir='center',
binwidth = 0.04,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = infected_X_time),
binaxis='y', stackdir='center',
binwidth = 0.15,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
ggthemes::theme_clean() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_blank(), # Enlever la bordure du panel
axis.title = element_text(size = 11),  # Thicken axis titles
axis.text = element_text(size = 10),  # Thicken axis text
axis.line = element_line(linewidth = 2),  # Thicken axis lines
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
legend.position =  "none"
)+
ylim(0, NA)+
labs(x = "Scenario", y = "Infected x Time")
p = plot_grid(p_equi.survi.ad,
p_infected_X_time,
p_nb_infected_colonies,
labels = c("A", "B", "C"),
ncol = 3)
print(p)
}
scenario_plot(beta_context = 0.5,
time_at_sea_NB_context = 40)
scenario_plot = function(beta_context,
time_at_sea_NB_context
){
no_stress =
stat_model(nb_iterations_ = 1,
induced_dispersal_ = F,
initial_number_infected_breeders_A_ = 0,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
baseline_outbreak =
stat_model(induced_dispersal_ = F,
initial_number_infected_breeders_A_ = 1,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
proactive_strategy =
stat_model(nb_iterations_ = 1,
induced_dispersal_ = T,
initial_number_infected_breeders_A_ = 0,
dispersal_stochactic_ = F,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
proactive_strategy_toolate =
stat_model(induced_dispersal_ = T,
initial_number_infected_breeders_A_ = 1,
dispersal_stochactic_ = F,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
reactive_strategy =
stat_model(induced_dispersal_ = T,
initial_number_infected_breeders_A_ = 1,
dispersal_stochactic_ = T,
dispersal_reaction_time_ = 2,
tau_ = 0.2,
BETA_ =  beta_context,
TIME_AT_SEA_NB_ = time_at_sea_NB_context)
dt_panel_5 =
data.frame(
scenario = c(
rep("Healty site", nrow(no_stress)),
rep("Baseline outbreak",nrow(baseline_outbreak)),
rep("Proactive strategy",nrow(proactive_strategy)),
rep("Proactive strategy - Too late",nrow(proactive_strategy_toolate)),
rep("Reactive strategy",nrow(reactive_strategy))
),
equi.lost.survi.ad = c(
0,
no_stress$nb_adults_equi - baseline_outbreak$nb_adults_equi,
no_stress$nb_adults_equi - proactive_strategy$nb_adults_equi,
no_stress$nb_adults_equi - proactive_strategy_toolate$nb_adults_equi,
no_stress$nb_adults_equi - reactive_strategy$nb_adults_equi
),
nb_infected_colonies = c(
no_stress$nb_infected_colonies,
baseline_outbreak$nb_infected_colonies,
proactive_strategy$nb_infected_colonies,
proactive_strategy_toolate$nb_infected_colonies,
reactive_strategy$nb_infected_colonies
),
infected_X_time = c(
no_stress$infected_X_time,
baseline_outbreak$infected_X_time,
proactive_strategy$infected_X_time,
proactive_strategy_toolate$infected_X_time,
reactive_strategy$infected_X_time
)
) %>%
mutate(scenario = factor(scenario, levels = c("Healty site",
"Baseline outbreak",
"Proactive strategy",
"Proactive strategy - Too late",
"Reactive strategy")))
p_equi.survi.ad = ggplot()+
geom_violin(data = dt_panel_5,
aes(x = scenario, y = equi.lost.survi.ad),
fill = "lightblue",
color = "white",
trim=FALSE, position=position_dodge(1)) +
geom_dotplot(data = dt_panel_5, aes(x = scenario, y = equi.lost.survi.ad),
binaxis='y', stackdir='center',
binwidth = 2,
color = "darkgrey", alpha = 0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = equi.lost.survi.ad),
binaxis='y', stackdir='center',
binwidth = 7,
fill = "lightblue",
color = "white",
stackratio=0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = equi.lost.survi.ad),
binaxis='y', stackdir='center',
binwidth = 1.5,
fill = "black",
color = "black",
stackratio=0.5)+
ggthemes::theme_clean() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_blank(), # Enlever la bordure du panel
axis.title = element_text(size = 11),  # Thicken axis titles
axis.text = element_text(size = 10),  # Thicken axis text
axis.line = element_line(linewidth = 2),  # Thicken axis lines
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
legend.position =  "none"
)+
ylim(0, NA)+
labs(x = "Scenario", y = "ENLA")
p_nb_infected_colonies = ggplot()+
geom_violin(data = dt_panel_5,
aes(x = scenario, y = nb_infected_colonies),
fill = "burlywood1",
color = "white",
trim=FALSE, position=position_dodge(1)) +
geom_dotplot(data = dt_panel_5,
aes(x = scenario, y = nb_infected_colonies),
binaxis='y', stackdir='center',
binwidth = 0.04,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = nb_infected_colonies),
binaxis='y', stackdir='center',
binwidth = 0.15,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
ggthemes::theme_clean() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_blank(), # Enlever la bordure du panel
axis.title = element_text(size = 11),  # Thicken axis titles
axis.text = element_text(size = 10),  # Thicken axis text
axis.line = element_line(linewidth = 2),  # Thicken axis lines
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
legend.position =  "none"
)+
ylim(0, 4)+
labs(x = "Scenario", y = "Number of infected colonies")
p_infected_X_time = ggplot()+
geom_violin(data = dt_panel_5,
aes(x = scenario, y = infected_X_time),
fill = "lightgreen",
color = "white",
trim=FALSE, position=position_dodge(1)) +
geom_dotplot(data = dt_panel_5,
aes(x = scenario, y = infected_X_time),
binaxis='y', stackdir='center',
binwidth = 0.04,
color = "darkgrey", alpha = 0.5,
stackratio=0.5)+
geom_dotplot(data =  dt_panel_5 %>% subset(., scenario %in% c("Healty site", "Proactive strategy")),
aes(x = scenario, y = infected_X_time),
binaxis='y', stackdir='center',
binwidth = 0.15,
color = "grey", alpha = 0.5,
stackratio=0.5)+
ggthemes::theme_clean() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
panel.border = element_blank(), # Enlever la bordure du panel
axis.title = element_text(size = 11),  # Thicken axis titles
axis.text = element_text(size = 10),  # Thicken axis text
axis.line = element_line(linewidth = 2),  # Thicken axis lines
panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
legend.position =  "none"
)+
ylim(0, NA)+
labs(x = "Scenario", y = "Infected x Time")
p = plot_grid(p_equi.survi.ad,
p_infected_X_time,
p_nb_infected_colonies,
labels = c("A", "B", "C"),
ncol = 3)
print(p)
}
scenario_plot(beta_context = 0.5,
time_at_sea_NB_context = 40)
